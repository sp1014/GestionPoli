!function(n,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("postRobot",[],e):"object"==typeof exports?exports.postRobot=e():n.postRobot=e()}("undefined"!=typeof self?self:this,function(){return function(n){var e={};function r(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return n[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=n,r.c=e,r.d=function(n,e,t){r.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:t})},r.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(e,"a",e),e},r.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},r.p="",r(r.s=8)}([function(n,e,r){"use strict";function t(n){return"[object RegExp]"===Object.prototype.toString.call(n)}var o={MOCK:"mock:",FILE:"file:",ABOUT:"about:"},i="*",a={IFRAME:"iframe",POPUP:"popup"},u="Call was rejected by callee.\r\n";function c(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).location.protocol===o.FILE}function d(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).location.protocol===o.ABOUT}function s(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(n)try{if(n.parent&&n.parent!==n)return n.parent}catch(n){}}function f(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;if(n&&!s(n))try{return n.opener}catch(n){}}function w(n){try{return n&&n.location&&n.location.href,!0}catch(n){}return!1}function l(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=n.location;if(!e)throw new Error("Can not read window location");var r=e.protocol;if(!r)throw new Error("Can not read window protocol");if(r===o.FILE)return o.FILE+"//";if(r===o.ABOUT){var t=s(n);return t&&w(t)?l(t):o.ABOUT+"//"}var i=e.host;if(!i)throw new Error("Can not read window host");return r+"//"+i}function h(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=l(n);return e&&n.mockDomain&&0===n.mockDomain.indexOf(o.MOCK)?n.mockDomain:e}function p(n){try{if(!n.location.href)return!0;if("about:blank"===n.location.href)return!0}catch(n){}return!1}function m(n){try{if(n===window)return!0}catch(n){}try{var e=Object.getOwnPropertyDescriptor(n,"location");if(e&&!1===e.enumerable)return!1}catch(n){}try{if(d(n)&&w(n))return!0}catch(n){}try{if(l(n)===l(window))return!0}catch(n){}return!1}function v(n){if(!m(n))return!1;try{if(n===window)return!0;if(d(n)&&w(n))return!0;if(h(window)===h(n))return!0}catch(n){}return!1}function O(n){if(!v(n))throw new Error("Expected window to be same domain");return n}function y(n){var e=[];try{for(;n.parent!==n;)e.push(n.parent),n=n.parent}catch(n){}return e}function E(n,e){if(!n||!e)return!1;var r=s(e);return r?r===n:-1!==y(e).indexOf(n)}function g(n){var e=[],r=void 0;try{r=n.frames}catch(e){r=n}var t=void 0;try{t=r.length}catch(n){}if(0===t)return e;if(t){for(var o=0;o<t;o++){var i=void 0;try{i=r[o]}catch(n){continue}e.push(i)}return e}for(var a=0;a<100;a++){var u=void 0;try{u=r[a]}catch(n){return e}if(!u)return e;e.push(u)}return e}function b(n){for(var e=[],r=0,t=g(n),o=null==t?0:t.length;r<o;r++){var i=t[r];e.push(i);for(var a=0,u=b(i),c=null==u?0:u.length;a<c;a++){var d=u[a];e.push(d)}}return e}function _(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;try{if(n.top)return n.top}catch(n){}if(s(n)===n)return n;try{if(E(window,n)&&window.top)return window.top}catch(n){}try{if(E(n,window)&&window.top)return window.top}catch(n){}for(var e=0,r=b(n),t=null==r?0:r.length;e<t;e++){var o=r[e];try{if(o.top)return o.top}catch(n){}if(s(o)===o)return o}}function S(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return f(_(n)||n)}function P(){var n=S(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window);return n?P(n):top}function T(n){var e=_(n);if(!e)throw new Error("Can not determine top window");return[].concat(b(e),[e])}function j(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=T(n),r=S(n);return r?[].concat(j(r),e):e}function A(n){return n===_(n)}function W(n){if(!n.contentWindow)return!0;if(!n.parentNode)return!0;var e=n.ownerDocument;return!(!e||!e.documentElement||e.documentElement.contains(n))}var R=[],I=[];function M(n){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(n===window)return!1}catch(n){return!0}try{if(!n)return!0}catch(n){return!0}try{if(n.closed)return!0}catch(n){return!n||n.message!==u}if(e&&v(n))try{if(n.mockclosed)return!0}catch(n){}try{if(!n.parent||!n.top)return!0}catch(n){}var r=function(n,e){for(var r=0;r<n.length;r++)try{if(n[r]===e)return r}catch(n){}return-1}(R,n);if(-1!==r){var t=I[r];if(t&&W(t))return!0}return!1}function L(n){if(function(){for(var n=0;n<R.length;n++){var e=!1;try{e=R[n].closed}catch(n){}e&&(I.splice(n,1),R.splice(n,1))}}(),n&&n.contentWindow)try{R.push(n.contentWindow),I.push(n)}catch(n){}}function N(n){return(n=n||window).navigator.mockUserAgent||n.navigator.userAgent}function D(n,e){for(var r=g(n),t=0,o=null==r?0:r.length;t<o;t++){var i=r[t];try{if(v(i)&&i.name===e&&-1!==r.indexOf(i))return i}catch(n){}}try{if(-1!==r.indexOf(n.frames[e]))return n.frames[e]}catch(n){}try{if(-1!==r.indexOf(n[e]))return n[e]}catch(n){}}function C(n,e){var r=D(n,e);if(r)return r;for(var t=0,o=g(n),i=null==o?0:o.length;t<i;t++){var a=C(o[t],e);if(a)return a}}function B(n,e){var r;return(r=D(n,e))?r:C(_(n)||n,e)}function x(n,e){var r=s(e);if(r)return r===n;for(var t=0,o=g(n),i=null==o?0:o.length;t<i;t++)if(o[t]===e)return!0;return!1}function k(n,e){return n===f(e)}function G(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return f(n=n||window)||s(n)||void 0}function U(n){for(var e=[],r=n;r;)(r=G(r))&&e.push(r);return e}function F(n,e){var r=G(e);if(r)return r===n;if(e===n)return!1;if(_(e)===e)return!1;for(var t=0,o=g(n),i=null==o?0:o.length;t<i;t++)if(o[t]===e)return!0;return!1}function q(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return Boolean(f(n))}function H(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return Boolean(s(n))}function Y(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return Boolean(!H(n)&&!q(n))}function J(n,e){for(var r=0,t=null==n?0:n.length;r<t;r++)for(var o=n[r],i=0,a=null==e?0:e.length;i<a;i++)if(o===e[i])return!0;return!1}function K(){for(var n=0,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e;)(e=s(e))&&(n+=1);return n}function Z(n){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=n,t=0;t<e;t++){if(!r)return;r=s(r)}return r}function z(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Z(n,K(n)-e)}function X(n,e){var r=_(n)||n,t=_(e)||e;try{if(r&&t)return r===t}catch(n){}var o=T(n),i=T(e);if(J(o,i))return!0;var a=f(r),u=f(t);return!(a&&J(T(a),i)||(u&&J(T(u),o),1))}function Q(n,e){if("string"==typeof n){if("string"==typeof e)return n===i||e===n;if(t(e))return!1;if(Array.isArray(e))return!1}return t(n)?t(e)?n.toString()===e.toString():!Array.isArray(e)&&Boolean(e.match(n)):!!Array.isArray(n)&&(Array.isArray(e)?JSON.stringify(n)===JSON.stringify(e):!t(e)&&n.some(function(n){return Q(n,e)}))}function V(n){return Array.isArray(n)?"("+n.join(" | ")+")":t(n)?"RegExp("+n.toString():n.toString()}function $(n){return n.match(/^(https?|mock|file):\/\//)?n.split("/").slice(0,3).join("/"):h()}function nn(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,o=void 0;return function i(){if(M(n))return o&&clearTimeout(o),e();t<=0?clearTimeout(o):(t-=r,o=setTimeout(i,r))}(),{cancel:function(){o&&clearTimeout(o)}}}function en(n){try{if(n===window)return!0}catch(n){if(n&&n.message===u)return!0}try{if("[object Window]"===Object.prototype.toString.call(n))return!0}catch(n){if(n&&n.message===u)return!0}try{if(window.Window&&n instanceof window.Window)return!0}catch(n){if(n&&n.message===u)return!0}try{if(n&&n.self===n)return!0}catch(n){if(n&&n.message===u)return!0}try{if(n&&n.parent===n)return!0}catch(n){if(n&&n.message===u)return!0}try{if(n&&n.top===n)return!0}catch(n){if(n&&n.message===u)return!0}try{if(n&&"__unlikely_value__"===n.__cross_domain_utils_window_check__)return!1}catch(n){return!0}return!1}function rn(){return"undefined"!=typeof window&&void 0!==window.location}function tn(n){return!!rn()&&h()===n}function on(n){return 0===n.indexOf(o.MOCK)}function an(n){if(!on($(n)))return n;throw new Error("Mock urls not supported out of test mode")}function un(n){try{n.close()}catch(n){}}function cn(n){if(v(n))return O(n).frameElement;for(var e=0,r=document.querySelectorAll("iframe"),t=null==r?0:r.length;e<t;e++){var o=r[e];if(o&&o.contentWindow&&o.contentWindow===n)return o}}r.d(e,!1,function(){return c}),r.d(e,!1,function(){return d}),r.d(e,"h",function(){return s}),r.d(e,"g",function(){return f}),r.d(e,!1,function(){return w}),r.d(e,"a",function(){return l}),r.d(e,"c",function(){return h}),r.d(e,!1,function(){return p}),r.d(e,"j",function(){return m}),r.d(e,"o",function(){return v}),r.d(e,!1,function(){return O}),r.d(e,!1,function(){return y}),r.d(e,!1,function(){return E}),r.d(e,"f",function(){return g}),r.d(e,!1,function(){return b}),r.d(e,!1,function(){return _}),r.d(e,!1,function(){return S}),r.d(e,!1,function(){return P}),r.d(e,!1,function(){return T}),r.d(e,!1,function(){return j}),r.d(e,!1,function(){return A}),r.d(e,!1,function(){return W}),r.d(e,"r",function(){return M}),r.d(e,!1,function(){return L}),r.d(e,"i",function(){return N}),r.d(e,"e",function(){return D}),r.d(e,!1,function(){return C}),r.d(e,!1,function(){return B}),r.d(e,!1,function(){return x}),r.d(e,"m",function(){return k}),r.d(e,"b",function(){return G}),r.d(e,!1,function(){return U}),r.d(e,"k",function(){return F}),r.d(e,"n",function(){return q}),r.d(e,"l",function(){return H}),r.d(e,!1,function(){return Y}),r.d(e,!1,function(){return K}),r.d(e,!1,function(){return Z}),r.d(e,!1,function(){return z}),r.d(e,"p",function(){return X}),r.d(e,"s",function(){return Q}),r.d(e,"t",function(){return V}),r.d(e,"d",function(){return $}),r.d(e,!1,function(){return nn}),r.d(e,"q",function(){return en}),r.d(e,!1,function(){return rn}),r.d(e,!1,function(){return tn}),r.d(e,!1,function(){return on}),r.d(e,!1,function(){return an}),r.d(e,!1,function(){return un}),r.d(e,!1,function(){return cn}),r.d(e,!1,function(){return!0}),r.d(e,!1,function(){return o}),r.d(e,!1,function(){return i}),r.d(e,!1,function(){return a})},function(n,e,r){"use strict";var t,o={POST_MESSAGE_TYPE:{REQUEST:"postrobot_message_request",RESPONSE:"postrobot_message_response",ACK:"postrobot_message_ack"},POST_MESSAGE_ACK:{SUCCESS:"success",ERROR:"error"},POST_MESSAGE_NAMES:{METHOD:"postrobot_method",HELLO:"postrobot_ready",OPEN_TUNNEL:"postrobot_open_tunnel"},WINDOW_TYPES:{FULLPAGE:"fullpage",POPUP:"popup",IFRAME:"iframe"},WINDOW_PROPS:{POSTROBOT:"__postRobot__"},SERIALIZATION_TYPES:{METHOD:"postrobot_method",ERROR:"postrobot_error",PROMISE:"postrobot_promise",ZALGO_PROMISE:"postrobot_zalgo_promise",REGEX:"regex"},SEND_STRATEGIES:{POST_MESSAGE:"postrobot_post_message",BRIDGE:"postrobot_bridge",GLOBAL:"postrobot_global"},MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",BRIDGE_NAME_PREFIX:"__postrobot_bridge__",POSTROBOT_PROXY:"__postrobot_proxy__",WILDCARD:"*"},i={METHOD:"postrobot_method",HELLO:"postrobot_hello",OPEN_TUNNEL:"postrobot_open_tunnel"},a=Object.keys(i).map(function(n){return i[n]}),u={ALLOW_POSTMESSAGE_POPUP:!("__ALLOW_POSTMESSAGE_POPUP__"in window)||window.__ALLOW_POSTMESSAGE_POPUP__,BRIDGE_TIMEOUT:5e3,CHILD_WINDOW_TIMEOUT:5e3,ACK_TIMEOUT:-1!==window.navigator.userAgent.match(/MSIE/i)?1e4:2e3,RES_TIMEOUT:-1,ALLOWED_POST_MESSAGE_METHODS:(t={},t[o.SEND_STRATEGIES.POST_MESSAGE]=!0,t[o.SEND_STRATEGIES.BRIDGE]=!0,t[o.SEND_STRATEGIES.GLOBAL]=!0,t),ALLOW_SAME_ORIGIN:!1};0===window.location.href.indexOf(o.FILE_PROTOCOL)&&(u.ALLOW_POSTMESSAGE_POPUP=!0),r.d(e,"a",function(){return u}),r.d(e,"b",function(){return o}),r.d(e,!1,function(){return i}),r.d(e,!1,function(){return a})},function(n,e,r){"use strict";function t(n){try{if(!n)return!1;if("undefined"!=typeof Promise&&n instanceof Promise)return!0;if("undefined"!=typeof window&&"function"==typeof window.Window&&n instanceof window.Window)return!1;if("undefined"!=typeof window&&"function"==typeof window.constructor&&n instanceof window.constructor)return!1;var e={}.toString;if(e){var r=e.call(n);if("[object Window]"===r||"[object global]"===r||"[object DOMWindow]"===r)return!1}if("function"==typeof n.then)return!0}catch(n){return!1}return!1}var o=[],i=[],a=0,u=void 0;function c(){if(!a&&u){var n=u;u=null,n.resolve()}}function d(){a+=1}function s(){a-=1,c()}var f=function(){function n(e){var r=this;if(function(e,r){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],e){var t=void 0,o=void 0,i=!1,a=!1,u=!1;d();try{e(function(n){u?r.resolve(n):(i=!0,t=n)},function(n){u?r.reject(n):(a=!0,o=n)})}catch(n){return s(),void this.reject(n)}s(),u=!0,i?this.resolve(t):a&&this.reject(o)}}return n.prototype.resolve=function(n){if(this.resolved||this.rejected)return this;if(t(n))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=n,this.dispatch(),this},n.prototype.reject=function(n){var e=this;if(this.resolved||this.rejected)return this;if(t(n))throw new Error("Can not reject promise with another promise");if(!n){var r=n&&"function"==typeof n.toString?n.toString():Object.prototype.toString.call(n);n=new Error("Expected reject to be called with Error, got "+r)}return this.rejected=!0,this.error=n,this.errorHandled||setTimeout(function(){e.errorHandled||function(n,e){if(-1===o.indexOf(n)){o.push(n),setTimeout(function(){throw n},1);for(var r=0;r<i.length;r++)i[r](n,e)}}(n,e)},1),this.dispatch(),this},n.prototype.asyncReject=function(n){return this.errorHandled=!0,this.reject(n),this},n.prototype.dispatch=function(){var e=this.dispatching,r=this.resolved,o=this.rejected,i=this.handlers;if(!e&&(r||o)){this.dispatching=!0,d();for(var a=function(n,e){return n.then(function(n){e.resolve(n)},function(n){e.reject(n)})},u=0;u<i.length;u++){var c=i[u],f=c.onSuccess,w=c.onError,l=c.promise,h=void 0;if(r)try{h=f?f(this.value):this.value}catch(n){l.reject(n);continue}else if(o){if(!w){l.reject(this.error);continue}try{h=w(this.error)}catch(n){l.reject(n);continue}}h instanceof n&&(h.resolved||h.rejected)?(h.resolved?l.resolve(h.value):l.reject(h.error),h.errorHandled=!0):t(h)?h instanceof n&&(h.resolved||h.rejected)?h.resolved?l.resolve(h.value):l.reject(h.error):a(h,l):l.resolve(h)}i.length=0,this.dispatching=!1,s()}},n.prototype.then=function(e,r){if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.then expected a function for success handler");if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for error handler");var t=new n;return this.handlers.push({promise:t,onSuccess:e,onError:r}),this.errorHandled=!0,this.dispatch(),t},n.prototype.catch=function(n){return this.then(void 0,n)},n.prototype.finally=function(e){if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.finally expected a function");return this.then(function(r){return n.try(e).then(function(){return r})},function(r){return n.try(e).then(function(){throw r})})},n.prototype.timeout=function(n,e){var r=this;if(this.resolved||this.rejected)return this;var t=setTimeout(function(){r.resolved||r.rejected||r.reject(e||new Error("Promise timed out after "+n+"ms"))},n);return this.then(function(n){return clearTimeout(t),n})},n.prototype.toPromise=function(){if("undefined"==typeof Promise)throw new TypeError("Could not find Promise");return Promise.resolve(this)},n.resolve=function(e){return e instanceof n?e:t(e)?new n(function(n,r){return e.then(n,r)}):(new n).resolve(e)},n.reject=function(e){return(new n).reject(e)},n.asyncReject=function(e){return(new n).asyncReject(e)},n.all=function(e){var r=new n,o=e.length,i=[];if(!o)return r.resolve(i),r;for(var a=function(n,e,t){return e.then(function(e){i[n]=e,0==(o-=1)&&r.resolve(i)},function(n){t.reject(n)})},u=0;u<e.length;u++){var c=e[u];if(c instanceof n){if(c.resolved){i[u]=c.value,o-=1;continue}}else if(!t(c)){i[u]=c,o-=1;continue}a(u,n.resolve(c),r)}return 0===o&&r.resolve(i),r},n.hash=function(e){var r={};return n.all(Object.keys(e).map(function(t){return n.resolve(e[t]).then(function(n){r[t]=n})})).then(function(){return r})},n.map=function(e,r){return n.all(e.map(r))},n.onPossiblyUnhandledException=function(n){return function(n){return i.push(n),{cancel:function(){i.splice(i.indexOf(n),1)}}}(n)},n.try=function(e,r,t){if(e&&"function"!=typeof e&&!e.call)throw new Error("Promise.try expected a function");var o=void 0;d();try{o=e.apply(r,t||[])}catch(e){return s(),n.reject(e)}return s(),n.resolve(o)},n.delay=function(e){return new n(function(n){setTimeout(n,e)})},n.isPromise=function(e){return!!(e&&e instanceof n)||t(e)},n.flush=function(){return e=u=u||new n,c(),e;var e},n}();r.d(e,"a",function(){return f})},function(n,e,r){"use strict";r.d(e,"a",function(){return o});var t=r(1),o=window[t.b.WINDOW_PROPS.POSTROBOT]=window[t.b.WINDOW_PROPS.POSTROBOT]||{};o.registerSelf=function(){}},function(n,e,r){"use strict";var t=r(5),o=r(0),i=r(1),a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function u(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(e>=3)return"stringifyError stack overflow";try{if(!n)return"<unknown error: "+Object.prototype.toString.call(n)+">";if("string"==typeof n)return n;if(n instanceof Error){var r=n&&n.stack,t=n&&n.message;if(r&&t)return-1!==r.indexOf(t)?r:t+"\n"+r;if(r)return r;if(t)return t}return"function"==typeof n.toString?n.toString():Object.prototype.toString.call(n)}catch(n){return"Error while stringifying error: "+u(n,e+1)}}var c=function(n){if(!n)return n;var e=!1;return function(){if(!e)return e=!0,n.apply(this,arguments)}};function d(){}function s(n,e,r){return n.addEventListener?n.addEventListener(e,r):n.attachEvent("on"+e,r),{cancel:function(){n.removeEventListener?n.removeEventListener(e,r):n.detachEvent("on"+e,r)}}}function f(){var n="0123456789abcdef";return"xxxxxxxxxx".replace(/./g,function(){return n.charAt(Math.floor(Math.random()*n.length))})}function w(n,e){for(var r=0;r<n.length;r++)e(n[r],r)}function l(n,e){for(var r in n)n.hasOwnProperty(r)&&e(n[r],r)}function h(n,e){Array.isArray(n)?w(n,e):"object"===(void 0===n?"undefined":a(n))&&null!==n&&l(n,e)}function p(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(r>=100)throw new Error("Self-referential object passed, or object contained too many layers");var t=void 0;if("object"!==(void 0===n?"undefined":a(n))||null===n||Array.isArray(n)){if(!Array.isArray(n))throw new TypeError("Invalid type: "+(void 0===n?"undefined":a(n)));t=[]}else t={};return h(n,function(n,o){var i=e(n,o);void 0!==i?t[o]=i:"object"===(void 0===n?"undefined":a(n))&&null!==n?t[o]=p(n,e,r+1):t[o]=n}),t}function m(n,e){var r=void 0;return r=setTimeout(function t(){r=setTimeout(t,e),n.call()},e),{cancel:function(){clearTimeout(r)}}}function v(n){return"[object RegExp]"===Object.prototype.toString.call(n)}var O=function(n){var e=new t.a;return function(r){var t=e.get(r);return void 0!==t?t:(void 0!==(t=n.call(this,r))&&e.set(r,t),t)}};function y(){return Object(o.n)()?i.b.WINDOW_TYPES.POPUP:Object(o.l)()?i.b.WINDOW_TYPES.IFRAME:i.b.WINDOW_TYPES.FULLPAGE}function E(n,e,r){var t=void 0,o=void 0;try{if("{}"!==JSON.stringify({})&&(t=Object.prototype.toJSON,delete Object.prototype.toJSON),"{}"!==JSON.stringify({}))throw new Error("Can not correctly serialize JSON objects");if("[]"!==JSON.stringify([])&&(o=Array.prototype.toJSON,delete Array.prototype.toJSON),"[]"!==JSON.stringify([]))throw new Error("Can not correctly serialize JSON objects")}catch(n){throw new Error("Can not repair JSON.stringify: "+n.message)}var i=JSON.stringify.call(this,n,e,r);try{t&&(Object.prototype.toJSON=t),o&&(Array.prototype.toJSON=o)}catch(n){throw new Error("Can not repair JSON.stringify: "+n.message)}return i}function g(n){return JSON.parse(n)}function b(){return!!Object(o.i)(window).match(/MSIE|trident|edge\/12|edge\/13/i)||!i.a.ALLOW_POSTMESSAGE_POPUP}var _=r(2),S=r(3),P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};S.a.methods=S.a.methods||new t.a;var T=c(function(){S.a.on(i.b.POST_MESSAGE_NAMES.METHOD,{origin:i.b.WILDCARD},function(n){var e=n.source,r=n.origin,t=n.data,i=S.a.methods.get(e);if(!i)throw new Error("Could not find any methods this window has privileges to call");var a=i[t.id];if(!a)throw new Error("Could not find method with id: "+t.id);if(!Object(o.s)(a.domain,r))throw new Error("Method domain "+a.domain+" does not match origin "+r);return _.a.try(function(){return a.method.apply({source:e,origin:r,data:t},t.args)}).then(function(n){return{result:n,id:t.id,name:t.name}})})});function j(n,e){return"object"===(void 0===n?"undefined":P(n))&&null!==n&&n.__type__===e}function A(n,e,r,t){var o=f(),a=S.a.methods.get(n);return a||(a={},S.a.methods.set(n,a)),a[o]={domain:e,method:r},{__type__:i.b.SERIALIZATION_TYPES.METHOD,__id__:o,__name__:t}}function W(n,e,r){return p({obj:r},function(r,t){return"function"==typeof r?A(n,e,r,t.toString()):r instanceof Error?(o=r,{__type__:i.b.SERIALIZATION_TYPES.ERROR,__message__:u(o),__code__:o.code}):window.Promise&&r instanceof window.Promise?function(n,e,r,t){return{__type__:i.b.SERIALIZATION_TYPES.PROMISE,__then__:A(n,e,function(n,e){return r.then(n,e)},t+".then")}}(n,e,r,t.toString()):_.a.isPromise(r)?function(n,e,r,t){return{__type__:i.b.SERIALIZATION_TYPES.ZALGO_PROMISE,__then__:A(n,e,function(n,e){return r.then(n,e)},t+".then")}}(n,e,r,t.toString()):v(r)?(a=r,{__type__:i.b.SERIALIZATION_TYPES.REGEX,__source__:a.source}):void 0;var o,a}).obj}function R(n,e,r){function t(){var t=Array.prototype.slice.call(arguments);return S.a.send(n,i.b.POST_MESSAGE_NAMES.METHOD,{id:r.__id__,name:r.__name__,args:t},{domain:e,timeout:-1}).then(function(n){return n.data.result},function(n){throw n})}return t.__name__=r.__name__,t.__xdomain__=!0,t.source=n,t.origin=e,t}function I(n,e,r){var t=new Error(r.__message__);return r.__code__&&(t.code=r.__code__),t}function M(n,e,r){return new _.a(function(t,o){return R(n,e,r.__then__)(t,o)})}function L(n,e,r){return window.Promise?new window.Promise(function(t,o){return R(n,e,r.__then__)(t,o)}):M(n,e,r)}function N(n,e,r){return new RegExp(r.__source__)}function D(n,e,r){return p({obj:r},function(r){if("object"===(void 0===r?"undefined":P(r))&&null!==r)return j(r,i.b.SERIALIZATION_TYPES.METHOD)?R(n,e,r):j(r,i.b.SERIALIZATION_TYPES.ERROR)?I(0,0,r):j(r,i.b.SERIALIZATION_TYPES.PROMISE)?L(n,e,r):j(r,i.b.SERIALIZATION_TYPES.ZALGO_PROMISE)?M(n,e,r):j(r,i.b.SERIALIZATION_TYPES.REGEX)?N(0,0,r):void 0}).obj}function C(n){S.a.on(i.b.POST_MESSAGE_NAMES.HELLO,{domain:i.b.WILDCARD},function(e){var r=e.source,t=e.origin;return n({source:r,origin:t})})}function B(n){return S.a.send(n,i.b.POST_MESSAGE_NAMES.HELLO,{},{domain:i.b.WILDCARD,timeout:-1}).then(function(n){return{origin:n.origin}})}function x(){C(function(n){var e=n.source,r=n.origin,t=S.a.readyPromises.get(e)||new _.a;t.resolve({origin:r}),S.a.readyPromises.set(e,t)});var n=Object(o.b)();n&&B(n).catch(d)}function k(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Window",t=S.a.readyPromises.get(n);return t||(t=new _.a,S.a.readyPromises.set(n,t),-1!==e&&setTimeout(function(){return t.reject(new Error(r+" did not load after "+e+"ms"))},e),t)}S.a.readyPromises=S.a.readyPromises||new t.a,r.d(e,"p",function(){return u}),r.d(e,"l",function(){return c}),r.d(e,"j",function(){return d}),r.d(e,"a",function(){return s}),r.d(e,"q",function(){return f}),r.d(e,!1,function(){return w}),r.d(e,!1,function(){return l}),r.d(e,!1,function(){return h}),r.d(e,!1,function(){return p}),r.d(e,"m",function(){return m}),r.d(e,"e",function(){return v}),r.d(e,"r",function(){return O}),r.d(e,"c",function(){return y}),r.d(e,"g",function(){return E}),r.d(e,"f",function(){return g}),r.d(e,"i",function(){return b}),r.d(e,"h",function(){return T}),r.d(e,!1,function(){return A}),r.d(e,"o",function(){return W}),r.d(e,!1,function(){return R}),r.d(e,!1,function(){return I}),r.d(e,!1,function(){return M}),r.d(e,!1,function(){return L}),r.d(e,!1,function(){return N}),r.d(e,"b",function(){return D}),r.d(e,!1,function(){return C}),r.d(e,"n",function(){return B}),r.d(e,"d",function(){return x}),r.d(e,"k",function(){return k})},function(n,e,r){"use strict";var t=r(0);function o(n,e){for(var r=0;r<n.length;r++)try{if(n[r]===e)return r}catch(n){}return-1}var i=function(){function n(){if(function(e,r){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__",function(){if("undefined"==typeof WeakMap)return!1;if(void 0===Object.freeze)return!1;try{var n=new WeakMap,e={};return Object.freeze(e),n.set(e,"__testvalue__"),"__testvalue__"===n.get(e)}catch(n){return!1}}())try{this.weakmap=new WeakMap}catch(n){}this.keys=[],this.values=[]}return n.prototype._cleanupClosedWindows=function(){for(var n=this.weakmap,e=this.keys,r=0;r<e.length;r++){var o=e[r];if(Object(t.q)(o)&&Object(t.r)(o)){if(n)try{n.delete(o)}catch(n){}e.splice(r,1),this.values.splice(r,1),r-=1}}},n.prototype.isSafeToReadWrite=function(n){if(Object(t.q)(n))return!1;try{n&&n.self,n&&n[this.name]}catch(n){return!1}return!0},n.prototype.set=function(n,e){if(!n)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.set(n,e)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var t=this.name,i=n[t];return void(i&&i[0]===n?i[1]=e:Object.defineProperty(n,t,{value:[n,e],writable:!0}))}catch(n){}this._cleanupClosedWindows();var a=this.keys,u=this.values,c=o(a,n);-1===c?(a.push(n),u.push(e)):u[c]=e},n.prototype.get=function(n){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{if(e.has(n))return e.get(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var r=n[this.name];return r&&r[0]===n?r[1]:void 0}catch(n){}this._cleanupClosedWindows();var t=o(this.keys,n);if(-1!==t)return this.values[t]},n.prototype.delete=function(n){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{e.delete(n)}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var r=n[this.name];r&&r[0]===n&&(r[0]=r[1]=void 0)}catch(n){}this._cleanupClosedWindows();var t=this.keys,i=o(t,n);-1!==i&&(t.splice(i,1),this.values.splice(i,1))},n.prototype.has=function(n){if(!n)throw new Error("WeakMap expected key");var e=this.weakmap;if(e)try{if(e.has(n))return!0}catch(n){delete this.weakmap}if(this.isSafeToReadWrite(n))try{var r=n[this.name];return!(!r||r[0]!==n)}catch(n){}return this._cleanupClosedWindows(),-1!==o(this.keys,n)},n.prototype.getOrSet=function(n,e){if(this.has(n))return this.get(n);var r=e();return this.set(n,r),r},n}();r.d(e,"a",function(){return i})},function(n,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=r(2),o=r(0),i=r(1),a=r(4),u=r(3);function c(n){try{u.a.tunnelWindows[n]&&delete u.a.tunnelWindows[n].source}catch(n){}delete u.a.tunnelWindows[n]}u.a.tunnelWindows=u.a.tunnelWindows||{},u.a.tunnelWindowId=0,u.a.openTunnelToParent=function(n){var e=n.name,r=n.source,t=n.canary,d=n.sendMessage,s=Object(o.h)(window);if(!s)throw new Error("No parent window found to open tunnel to");var f=function(n){var e=n.name,r=n.source,t=n.canary,i=n.sendMessage;return function(){for(var n=u.a.tunnelWindows,e=0,r=Object.keys(n),t=null==r?0:r.length;e<t;e++){var i=r[e],d=n[i];try{Object(a.j)(d.source)}catch(n){c(i);continue}Object(o.r)(d.source)&&c(i)}}(),u.a.tunnelWindowId+=1,u.a.tunnelWindows[u.a.tunnelWindowId]={name:e,source:r,canary:t,sendMessage:i},u.a.tunnelWindowId}({name:e,source:r,canary:t,sendMessage:d});return u.a.send(s,i.b.POST_MESSAGE_NAMES.OPEN_TUNNEL,{name:e,sendMessage:function(){var n=function(n){return u.a.tunnelWindows[n]}(f);try{Object(a.j)(n&&n.source)}catch(n){return void c(f)}if(n&&n.source&&!Object(o.r)(n.source)){try{n.canary()}catch(n){return}n.sendMessage.apply(this,arguments)}}},{domain:i.b.WILDCARD})};var d=r(5);function s(){return!!Object(o.i)(window).match(/MSIE|trident|edge\/12|edge\/13/i)||!i.a.ALLOW_POSTMESSAGE_POPUP}function f(n){return!Object(o.p)(window,n)}function w(n,e){if(n){if(Object(o.c)()!==Object(o.d)(n))return!0}else if(e&&!Object(o.o)(e))return!0;return!1}function l(n){var e=n.win,r=n.domain;return!(!s()||r&&!w(r,e)||e&&!f(e))}function h(n){var e=(n=n||Object(o.d)(n)).replace(/[^a-zA-Z0-9]+/g,"_");return i.b.BRIDGE_NAME_PREFIX+"_"+e}function p(){return Boolean(window.name&&window.name===h(Object(o.c)()))}var m=new t.a(function(n){if(window.document&&window.document.body)return n(window.document.body);var e=setInterval(function(){if(window.document&&window.document.body)return clearInterval(e),n(window.document.body)},10)});function v(n){u.a.remoteWindows.set(n,{sendMessagePromise:new t.a})}function O(n){return u.a.remoteWindows.get(n)}function y(n,e,r){var i=O(n);if(!i)throw new Error("Window not found to register sendMessage to");var a=function(t,i,a){if(t!==n)throw new Error("Remote window does not match window");if(!Object(o.s)(a,e))throw new Error("Remote domain "+a+" does not match domain "+e);r(i)};i.sendMessagePromise.resolve(a),i.sendMessagePromise=t.a.resolve(a)}function E(n,e){var r=O(n);if(!r)throw new Error("Window not found on which to reject sendMessage");r.sendMessagePromise.asyncReject(e)}function g(n,e,r){var t=Object(o.m)(window,n),i=Object(o.m)(n,window);if(!t&&!i)throw new Error("Can only send messages to and from parent and popup windows");var a=O(n);if(!a)throw new Error("Window not found to send message to");return a.sendMessagePromise.then(function(t){return t(n,e,r)})}u.a.remoteWindows=u.a.remoteWindows||new d.a;var b=Object(a.r)(function(n){return t.a.try(function(){for(var e=0,r=Object(o.f)(n),a=null==r?0:r.length;e<a;e++){var u=r[e];try{if(u&&u!==window&&Object(o.o)(u)&&u[i.b.WINDOW_PROPS.POSTROBOT])return u}catch(n){continue}}try{var c=Object(o.e)(n,h(Object(o.c)()));if(!c)return;return Object(o.o)(c)&&c[i.b.WINDOW_PROPS.POSTROBOT]?c:new t.a(function(n){var e=void 0,r=void 0;e=setInterval(function(){if(c&&Object(o.o)(c)&&c[i.b.WINDOW_PROPS.POSTROBOT])return clearInterval(e),clearTimeout(r),n(c)},100),r=setTimeout(function(){return clearInterval(e),n()},2e3)})}catch(n){}})});function _(){return t.a.try(function(){var n=Object(o.g)(window);if(n&&l({win:n}))return v(n),b(n).then(function(e){return e?window.name?e[i.b.WINDOW_PROPS.POSTROBOT].openTunnelToParent({name:window.name,source:window,canary:function(){},sendMessage:function(n){try{Object(a.j)(window)}catch(n){return}if(window&&!window.closed)try{u.a.receiveMessage({data:n,origin:this.origin,source:this.source})}catch(n){t.a.reject(n)}}}).then(function(e){var r=e.source,t=e.origin,o=e.data;if(r!==n)throw new Error("Source does not match opener");y(r,t,o.sendMessage)}).catch(function(e){throw E(n,e),e}):E(n,new Error("Can not register with opener: window does not have a name")):E(n,new Error("Can not register with opener: no bridge found in opener"))})})}function S(n,e){return e=e||Object(o.d)(n),Boolean(u.a.bridges[e])}function P(n,e){return e=e||Object(o.d)(n),u.a.bridges[e]?u.a.bridges[e]:(u.a.bridges[e]=t.a.try(function(){if(Object(o.c)()===e)throw new Error("Can not open bridge on the same domain as current domain: "+e);var r=h(e);if(Object(o.e)(window,r))throw new Error("Frame with name "+r+" already exists on page");var c=function(n,e){var r=document.createElement("iframe");return r.setAttribute("name",n),r.setAttribute("id",n),r.setAttribute("style","display: none; margin: 0; padding: 0; border: 0px none; overflow: hidden;"),r.setAttribute("frameborder","0"),r.setAttribute("border","0"),r.setAttribute("scrolling","no"),r.setAttribute("allowTransparency","true"),r.setAttribute("tabindex","-1"),r.setAttribute("hidden","true"),r.setAttribute("title",""),r.setAttribute("role","presentation"),r.src=e,r}(r,n);return u.a.bridgeFrames[e]=c,m.then(function(r){r.appendChild(c);var o=c.contentWindow;return function(n,e){u.a.on(i.b.POST_MESSAGE_NAMES.OPEN_TUNNEL,{window:n,domain:e},function(n){var r=n.origin,o=n.data;if(r!==e)throw new Error("Domain "+e+" does not match origin "+r);if(!o.name)throw new Error("Register window expected to be passed window name");if(!o.sendMessage)throw new Error("Register window expected to be passed sendMessage method");if(!u.a.popupWindowsByName[o.name])throw new Error("Window with name "+o.name+" does not exist, or was not opened by this window");if(!u.a.popupWindowsByName[o.name].domain)throw new Error("We do not have a registered domain for window "+o.name);if(u.a.popupWindowsByName[o.name].domain!==r)throw new Error("Message origin "+r+" does not matched registered window origin "+u.a.popupWindowsByName[o.name].domain);return y(u.a.popupWindowsByName[o.name].win,e,o.sendMessage),{sendMessage:function(n){if(window&&!window.closed){var e=u.a.popupWindowsByName[o.name];if(e)try{u.a.receiveMessage({data:n,origin:e.domain,source:e.win})}catch(n){t.a.reject(n)}}}}})}(o,e),new t.a(function(n,e){c.onload=n,c.onerror=e}).then(function(){return Object(a.k)(o,i.a.BRIDGE_TIMEOUT,"Bridge "+n)}).then(function(){return o})})}),u.a.bridges[e])}u.a.bridges=u.a.bridges||{},u.a.bridgeFrames=u.a.bridgeFrames||{},u.a.popupWindowsByWin=u.a.popupWindowsByWin||new d.a,u.a.popupWindowsByName=u.a.popupWindowsByName||{};var T=window.open;function j(n,e){var r=u.a.popupWindowsByWin.get(n);r&&(r.domain=Object(o.d)(e),v(n))}function A(){for(var n=0,e=Object.keys(u.a.bridgeFrames),r=null==e?0:e.length;n<r;n++){var t=e[n],o=u.a.bridgeFrames[t];o.parentNode&&o.parentNode.removeChild(o)}u.a.bridgeFrames={},u.a.bridges={}}window.open=function(n,e,r,t){var a=n;if(n&&0===n.indexOf(i.b.MOCK_PROTOCOL)){var c=n.split("|");a=c[0],n=c[1]}a&&(a=Object(o.d)(a));var d=T.call(this,n,e,r,t);if(!d)return d;n&&v(d);for(var s=0,f=Object.keys(u.a.popupWindowsByName),w=null==f?0:f.length;s<w;s++){var l=f[s];Object(o.r)(u.a.popupWindowsByName[l].win)&&delete u.a.popupWindowsByName[l]}if(e&&d){var h=u.a.popupWindowsByWin.get(d)||u.a.popupWindowsByName[e]||{};h.name=h.name||e,h.win=h.win||d,h.domain=h.domain||a,u.a.popupWindowsByWin.set(d,h),u.a.popupWindowsByName[e]=h}return d},r.d(e,"openTunnelToOpener",function(){return _}),r.d(e,"needsBridgeForBrowser",function(){return s}),r.d(e,"needsBridgeForWin",function(){return f}),r.d(e,"needsBridgeForDomain",function(){return w}),r.d(e,"needsBridge",function(){return l}),r.d(e,"getBridgeName",function(){return h}),r.d(e,"isBridge",function(){return p}),r.d(e,"documentBodyReady",function(){return m}),r.d(e,"registerRemoteWindow",function(){return v}),r.d(e,"findRemoteWindow",function(){return O}),r.d(e,"registerRemoteSendMessage",function(){return y}),r.d(e,"rejectRemoteSendMessage",function(){return E}),r.d(e,"sendBridgeMessage",function(){return g}),r.d(e,"hasBridge",function(){return S}),r.d(e,"openBridge",function(){return P}),r.d(e,"linkUrl",function(){return j}),r.d(e,"destroyBridges",function(){return A})},function(n,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=r(0),o=r(1);function i(n,e){if(!o.a.ALLOW_POSTMESSAGE_POPUP&&!1===Object(t.p)(n,e))throw new Error("Can not send and receive post messages between two different windows (disabled to emulate IE)")}r.d(e,"emulateIERestrictions",function(){return i})},function(n,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t={};r.d(t,"cleanUpWindow",function(){return k}),r.d(t,"Promise",function(){return c.a}),r.d(t,"bridge",function(){return G}),r.d(t,"init",function(){return U}),r.d(t,"parent",function(){return x}),r.d(t,"send",function(){return W}),r.d(t,"request",function(){return A}),r.d(t,"sendToParent",function(){return R}),r.d(t,"client",function(){return I}),r.d(t,"on",function(){return N}),r.d(t,"listen",function(){return L}),r.d(t,"once",function(){return D}),r.d(t,"listener",function(){return C}),r.d(t,"CONFIG",function(){return a.a}),r.d(t,"CONSTANTS",function(){return a.b}),r.d(t,"disable",function(){return B});var o=r(4),i=r(0),a=r(1),u=r(3),c=r(2),d={};d[a.b.SEND_STRATEGIES.POST_MESSAGE]=function(n,e,t){try{r(7).emulateIERestrictions(window,n)}catch(n){return}(Array.isArray(t)?t:"string"==typeof t?[t]:[a.b.WILDCARD]).map(function(e){if(0===e.indexOf(a.b.MOCK_PROTOCOL)){if(window.location.protocol===a.b.FILE_PROTOCOL)return a.b.WILDCARD;if(!Object(i.j)(n))throw new Error("Attempting to send messsage to mock domain "+e+", but window is actually cross-domain");return Object(i.a)(n)}return 0===e.indexOf(a.b.FILE_PROTOCOL)?a.b.WILDCARD:e}).forEach(function(r){return n.postMessage(e,r)})};var s=r(6),f=s.sendBridgeMessage,w=s.needsBridgeForBrowser,l=s.isBridge;d[a.b.SEND_STRATEGIES.BRIDGE]=function(n,e,r){if(w()||l()){if(Object(i.o)(n))throw new Error("Post message through bridge disabled between same domain windows");if(!1!==Object(i.p)(window,n))throw new Error("Can only use bridge to communicate between two different windows, not between frames");return f(n,e,r)}},d[a.b.SEND_STRATEGIES.GLOBAL]=function(n,e){if(Object(o.i)()){if(!Object(i.o)(n))throw new Error("Post message through global disabled between different domain windows");if(!1!==Object(i.p)(window,n))throw new Error("Can only use global to communicate between two different windows, not between frames");var r=n[a.b.WINDOW_PROPS.POSTROBOT];if(!r)throw new Error("Can not find postRobot global on foreign window");return r.receiveMessage({source:window,origin:Object(i.c)(),data:e})}};var h=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}return n};function p(n,e,r){return c.a.try(function(){var t;if(e=function(n,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},t=Object(o.q)(),a=Object(o.c)(),u=Object(i.c)(window);return h({},e,r,{sourceDomain:u,id:e.id||t,windowType:a})}(n,e,{data:Object(o.o)(n,r,e.data),domain:r}),n===window&&!a.a.ALLOW_SAME_ORIGIN)throw new Error("Attemping to send message to self");if(Object(i.r)(n))throw new Error("Window is closed");var u=[],s=Object(o.g)(((t={})[a.b.WINDOW_PROPS.POSTROBOT]=e,t),null,2);return c.a.map(Object.keys(d),function(e){return c.a.try(function(){if(!a.a.ALLOWED_POST_MESSAGE_METHODS[e])throw new Error("Strategy disallowed: "+e);return d[e](n,s,r)}).then(function(){return u.push(e+": success"),!0},function(n){return u.push(e+": "+Object(o.p)(n)+"\n"),!1})}).then(function(n){var r=n.some(Boolean),t=e.type+" "+e.name+" "+(r?"success":"error")+":\n  - "+u.join("\n  - ")+"\n";if(!r)throw new Error(t)})})}var m=r(5);u.a.responseListeners=u.a.responseListeners||{},u.a.requestListeners=u.a.requestListeners||{},u.a.WINDOW_WILDCARD=u.a.WINDOW_WILDCARD||new function(){},u.a.erroredResponseListeners=u.a.erroredResponseListeners||{};var v,O="__domain_regex__";function y(n){return u.a.responseListeners[n]}function E(n){delete u.a.responseListeners[n]}function g(n){return Boolean(u.a.erroredResponseListeners[n])}function b(n){var e=n.name,r=n.win,t=n.domain;if(r===a.b.WILDCARD&&(r=null),t===a.b.WILDCARD&&(t=null),!e)throw new Error("Name required to get request listener");var o=u.a.requestListeners[e];if(o)for(var c=0,d=[r,u.a.WINDOW_WILDCARD],s=null==d?0:d.length;c<s;c++){var f=d[c],w=f&&o.get(f);if(w){if(t&&"string"==typeof t){if(w[t])return w[t];if(w[O])for(var l=0,h=w[O],p=null==h?0:h.length;l<p;l++){var m=h[l],v=m.regex,y=m.listener;if(Object(i.s)(v,t))return y}}if(w[a.b.WILDCARD])return w[a.b.WILDCARD]}}}var _=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}return n},S=((v={})[a.b.POST_MESSAGE_TYPE.ACK]=function(n,e,r){if(!g(r.hash)){var t=y(r.hash);if(!t)throw new Error("No handler found for post message ack for message: "+r.name+" from "+e+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!Object(i.s)(t.domain,e))throw new Error("Ack origin "+e+" does not match domain "+t.domain.toString());t.ack=!0}},v[a.b.POST_MESSAGE_TYPE.REQUEST]=function(n,e,r){var t=b({name:r.name,win:n,domain:e});function u(t){return r.fireAndForget||Object(i.r)(n)?c.a.resolve():p(n,_({target:r.originalSource,hash:r.hash,name:r.name},t),e)}return c.a.all([u({type:a.b.POST_MESSAGE_TYPE.ACK}),c.a.try(function(){if(!t)throw new Error("No handler found for post message: "+r.name+" from "+e+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!Object(i.s)(t.domain,e))throw new Error("Request origin "+e+" does not match domain "+t.domain.toString());var o=r.data;return t.handler({source:n,origin:e,data:o})}).then(function(n){return u({type:a.b.POST_MESSAGE_TYPE.RESPONSE,ack:a.b.POST_MESSAGE_ACK.SUCCESS,data:n})},function(n){var e=Object(o.p)(n).replace(/^Error: /,""),r=n.code;return u({type:a.b.POST_MESSAGE_TYPE.RESPONSE,ack:a.b.POST_MESSAGE_ACK.ERROR,error:e,code:r})})]).then(o.j).catch(function(n){if(t&&t.handleError)return t.handleError(n);throw n})},v[a.b.POST_MESSAGE_TYPE.RESPONSE]=function(n,e,r){if(!g(r.hash)){var t=y(r.hash);if(!t)throw new Error("No handler found for post message response for message: "+r.name+" from "+e+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!Object(i.s)(t.domain,e))throw new Error("Response origin "+e+" does not match domain "+Object(i.t)(t.domain));if(E(r.hash),r.ack===a.b.POST_MESSAGE_ACK.ERROR){var o=new Error(r.error);return r.code&&(o.code=r.code),t.respond(o,null)}if(r.ack===a.b.POST_MESSAGE_ACK.SUCCESS){var u=r.data||r.response;return t.respond(null,{source:n,origin:e,data:u})}}},v),P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function T(n){if(window&&!window.closed){try{if(!n.source)return}catch(n){return}var e=n.source,r=n.origin,t=function(n){var e=void 0;try{e=Object(o.f)(n)}catch(n){return}if(e&&"object"===(void 0===e?"undefined":P(e))&&null!==e&&(e=e[a.b.WINDOW_PROPS.POSTROBOT])&&"object"===(void 0===e?"undefined":P(e))&&null!==e&&e.type&&"string"==typeof e.type&&S[e.type])return e}(n.data);if(t){if(!t.sourceDomain||"string"!=typeof t.sourceDomain)throw new Error("Expected message to have sourceDomain");0!==t.sourceDomain.indexOf(a.b.MOCK_PROTOCOL)&&0!==t.sourceDomain.indexOf(a.b.FILE_PROTOCOL)||(r=t.sourceDomain),-1===u.a.receivedMessages.indexOf(t.id)&&(u.a.receivedMessages.push(t.id),Object(i.r)(e)&&!t.fireAndForget||(t.data&&(t.data=Object(o.b)(e,r,t.data)),S[t.type](e,r,t)))}}}function j(n){try{Object(o.j)(n.source)}catch(n){return}var e={source:n.source||n.sourceElement,origin:n.origin||n.originalEvent&&n.originalEvent.origin,data:n.data};try{r(7).emulateIERestrictions(e.source,window)}catch(n){return}T(e)}function A(n){return c.a.try(function(){if(!n.name)throw new Error("Expected options.name");var e=n.name,r=void 0,t=void 0;if("string"==typeof n.window){var d=document.getElementById(n.window);if(!d)throw new Error("Expected options.window "+Object.prototype.toString.call(n.window)+" to be a valid element id");if("iframe"!==d.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(n.window)+" to be an iframe");if(!d.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");r=d.contentWindow}else if(n.window instanceof HTMLIFrameElement){if("iframe"!==n.window.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(n.window)+" to be an iframe");if(n.window&&!n.window.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");n.window&&n.window.contentWindow&&(r=n.window.contentWindow)}else r=n.window;if(!r)throw new Error("Expected options.window to be a window object, iframe, or iframe element id.");var s=r;t=n.domain||a.b.WILDCARD;var f=n.name+"_"+Object(o.q)();if(Object(i.r)(s))throw new Error("Target window is closed");var w=!1,l=u.a.requestPromises.get(s);l||(l=[],u.a.requestPromises.set(s,l));var h=c.a.try(function(){if(Object(i.k)(window,s))return Object(o.k)(s,n.timeout||a.a.CHILD_WINDOW_TIMEOUT)}).then(function(){var n=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).origin;if(Object(o.e)(t)&&!n)return Object(o.n)(s)}).then(function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).origin;if(Object(o.e)(t)){if(!Object(i.s)(t,r))throw new Error("Remote window domain "+r+" does not match regex: "+t.toString());t=r}if("string"!=typeof t&&!Array.isArray(t))throw new TypeError("Expected domain to be a string or array");var d=t;return new c.a(function(r,t){var o=void 0;if(n.fireAndForget||function(n,e){u.a.responseListeners[n]=e}(f,o={name:e,window:s,domain:d,respond:function(n,e){n||(w=!0,l.splice(l.indexOf(h,1))),n?t(n):r(e)}}),p(s,{type:a.b.POST_MESSAGE_TYPE.REQUEST,hash:f,name:e,data:n.data,fireAndForget:n.fireAndForget},d).catch(t),n.fireAndForget)return r();var c=a.a.ACK_TIMEOUT,m=n.timeout||a.a.RES_TIMEOUT,v=100;setTimeout(function r(){if(!w){if(Object(i.r)(s))return o.ack?t(new Error("Window closed for "+e+" before response")):t(new Error("Window closed for "+e+" before ack"));if(c=Math.max(c-v,0),-1!==m&&(m=Math.max(m-v,0)),o.ack){if(-1===m)return;v=Math.min(m,2e3)}else{if(0===c)return t(new Error("No ack for postMessage "+e+" in "+Object(i.c)()+" in "+a.a.ACK_TIMEOUT+"ms"));if(0===m)return t(new Error("No response for postMessage "+e+" in "+Object(i.c)()+" in "+(n.timeout||a.a.RES_TIMEOUT)+"ms"))}setTimeout(r,v)}},v)})});return h.catch(function(){!function(n){u.a.erroredResponseListeners[n]=!0}(f),E(f)}),l.push(h),h})}function W(n,e,r,t){return(t=t||{}).window=n,t.name=e,t.data=r,A(t)}function R(n,e,r){var t=Object(i.b)();return t?W(t,n,e,r):new c.a(function(n,e){return e(new Error("Window does not have a parent"))})}function I(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!n.window)throw new Error("Expected options.window");var e=n.window;return{send:function(r,t){return W(e,r,t,n)}}}u.a.receivedMessages=u.a.receivedMessages||[],u.a.receiveMessage=T,u.a.requestPromises=u.a.requestPromises||new m.a,u.a.send=W;var M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};function L(n){if(!n.name)throw new Error("Expected options.name");if(!n.handler)throw new Error("Expected options.handler");var e=n.name,r=n.window,t=n.domain,c={handler:n.handler,handleError:n.errorHandler||function(n){throw n},window:r,domain:t||a.b.WILDCARD,name:e},d=function n(e,r){var t=e.name,i=e.win,c=e.domain;if(!t||"string"!=typeof t)throw new Error("Name required to add request listener");if(Array.isArray(i)){for(var d=[],s=0,f=i,w=null==f?0:f.length;s<w;s++){var l=f[s];d.push(n({name:t,domain:c,win:l},r))}return{cancel:function(){for(var n=0,e=null==d?0:d.length;n<e;n++)d[n].cancel()}}}if(Array.isArray(c)){for(var h=[],p=0,v=c,y=null==v?0:v.length;p<y;p++){var E=v[p];h.push(n({name:t,win:i,domain:E},r))}return{cancel:function(){for(var n=0,e=null==h?0:h.length;n<e;n++)h[n].cancel()}}}var g=b({name:t,win:i,domain:c});if(i&&i!==a.b.WILDCARD||(i=u.a.WINDOW_WILDCARD),c=c||a.b.WILDCARD,g)throw i&&c?new Error("Request listener already exists for "+t+" on domain "+c.toString()+" for "+(i===u.a.WINDOW_WILDCARD?"wildcard":"specified")+" window"):i?new Error("Request listener already exists for "+t+" for "+(i===u.a.WINDOW_WILDCARD?"wildcard":"specified")+" window"):c?new Error("Request listener already exists for "+t+" on domain "+c.toString()):new Error("Request listener already exists for "+t);var _=u.a.requestListeners,S=_[t];S||(S=new m.a,_[t]=S);var P=S.get(i);P||(P={},S.set(i,P));var T=c.toString(),j=P[O],A=void 0;return Object(o.e)(c)?(j||(j=[],P[O]=j),A={regex:c,listener:r},j.push(A)):P[T]=r,{cancel:function(){P&&(delete P[T],i&&0===Object.keys(P).length&&S.delete(i),A&&j.splice(j.indexOf(A,1)))}}}({name:e,win:r,domain:t},c);if(n.once){var s=c.handler;c.handler=Object(o.l)(function(){return d.cancel(),s.apply(this,arguments)})}if(c.window&&n.errorOnClose)var f=Object(o.m)(function(){r&&"object"===(void 0===r?"undefined":M(r))&&Object(i.r)(r)&&(f.cancel(),c.handleError(new Error("Post message target window is closed")))},50);return{cancel:function(){d.cancel()}}}function N(n,e,r){return"function"==typeof e&&(r=e,e={}),(e=e||{}).name=n,e.handler=r||e.handler,L(e)}function D(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];"function"==typeof e&&(r=e,e={}),e=e||{},r=r||e.handler;var t=e.errorHandler,o=new c.a(function(o,i){(e=e||{}).name=n,e.once=!0,e.handler=function(n){if(o(n),r)return r(n)},e.errorHandler=function(n){if(i(n),t)return t(n)}}),i=L(e);return o.cancel=i.cancel,o}function C(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{on:function(e,r){return N(e,n,r)}}}function B(){delete window[a.b.WINDOW_PROPS.POSTROBOT],window.removeEventListener("message",j)}u.a.on=N;var x=Object(i.b)();function k(n){var e=u.a.requestPromises.get(n);if(e)for(var r=0,t=null==e?0:e.length;r<t;r++)e[r].reject(new Error("No response from window - cleaned up"));u.a.popupWindowsByWin&&u.a.popupWindowsByWin.delete(n),u.a.remoteWindows&&u.a.remoteWindows.delete(n),u.a.requestPromises.delete(n),u.a.methods.delete(n),u.a.readyPromises.delete(n)}var G=r(9);function U(){u.a.initialized||(Object(o.a)(window,"message",j),r(6).openTunnelToOpener(),Object(o.d)(),Object(o.h)({on:N,send:W})),u.a.initialized=!0}U(),r.d(e,"cleanUpWindow",function(){return k}),r.d(e,"Promise",function(){return c.a}),r.d(e,"bridge",function(){return G}),r.d(e,"init",function(){return U}),r.d(e,"parent",function(){return x}),r.d(e,"send",function(){return W}),r.d(e,"request",function(){return A}),r.d(e,"sendToParent",function(){return R}),r.d(e,"client",function(){return I}),r.d(e,"on",function(){return N}),r.d(e,"listen",function(){return L}),r.d(e,"once",function(){return D}),r.d(e,"listener",function(){return C}),r.d(e,"CONFIG",function(){return a.a}),r.d(e,"CONSTANTS",function(){return a.b}),r.d(e,"disable",function(){return B}),e.default=t},function(n,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t=r(6);r.d(e,"openBridge",function(){return t.openBridge}),r.d(e,"linkUrl",function(){return t.linkUrl}),r.d(e,"isBridge",function(){return t.isBridge}),r.d(e,"needsBridge",function(){return t.needsBridge}),r.d(e,"needsBridgeForBrowser",function(){return t.needsBridgeForBrowser}),r.d(e,"hasBridge",function(){return t.hasBridge}),r.d(e,"needsBridgeForWin",function(){return t.needsBridgeForWin}),r.d(e,"needsBridgeForDomain",function(){return t.needsBridgeForDomain}),r.d(e,"openTunnelToOpener",function(){return t.openTunnelToOpener}),r.d(e,"destroyBridges",function(){return t.destroyBridges})}])});
//# sourceMappingURL=post-robot.ie.min.js.map